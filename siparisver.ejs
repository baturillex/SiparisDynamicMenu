<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Söyle Gelsin</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.4/css/bulma.min.css" />
    <link rel="stylesheet" type="text/css" href="/css/siparisver.css" />
    <link rel="stylesheet" type="text/css" href=" https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js" />
    <link rel="stylesheet" type="text/css" href="https://use.fontawesome.com/1fa2e54b22.js" />

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous" />
    <script defer src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"></script>
    <script type="text/javascript" src="/views/jquery.js"></script>
</head>




<body>






    <form action="/siparisver" method="POST" enctype="application/x-www-form-urlencoded">
        /
        <div class="content">
            <div class="devideDIV">
                <% veri2.forEach(function(İmgAc){ %>
                <span name="siparisverilenmekanadi"><%=İmgAc.MekanAdi%>&nbsp;&nbsp;&nbsp;&nbsp;
                    &nbsp;
                    Siparişinizi Hemen Oluşturabilirsiniz
                    <div class="cartIconDIV"></div>
                </span>

                <h1 class="denemeler"><%=İmgAc.MekanAdi%></h1>
                <input type="hidden" id="ss" name="batux" value="deneme123">
                <% }); %>
            </div>
            <div class="cartTop">
                <!-- <div class="countBalance">
                <span style="color:#FF6347">温馨提示:</span>
                您的账户余额为:
                <span style="color:#FF6347;font-size:24px;">￥</span>

            </div> -->
                <!-- <div class="addressDIV">
                <span>收货地址管理</span>
            </div> -->
            </div>
            <div style="clear:both;"></div>

            <div class="cartMain">
                <table id="cartTable">
                    <thead>
                        <tr>
                            <th>
                                <label for="fl select-all">
                                    <input type="checkbox" class="check-all check" />
                                    <span><a href="javascript:void(0)" class="selallSPAN">&nbsp;</a></span>
                                </label>
                            </th>
                            <th>Ürün Adı</th>
                            <th>Fiyat</th>
                            <th>Adet</th>

                            <th>Toplam Fiyat</th>

                        </tr>
                    </thead>
                    <tbody>

                        <% veri.forEach(function(İmgAc){ %>

                        <td class="checkbox">
                            <input type="checkbox" class="check-one check" />
                        </td>
                        <td class="goods">
                            <img src="https://i.imgyukle.com/2020/04/25/Q7D0SP.jpg" alt="" />
                            <span><a href="##" id="ismibaba" class="goodsTitle"><%=İmgAc.Ad%></a></span><br />
                            <span></span><br />
                            <!-- <span><a href="##" class="sellerTitle"></a></span> -->
                        </td>
                        <td class="price"><%=İmgAc.Fiyat%></td>
                        <td class="count">
                            <span class="reduce"></span>
                            <input type="number" class="count-input" value="1" id="quantity" />
                            <span class="add">+</span>
                        </td>
                        <td class="subtotal">0</td>
                        <td class="opration">
                            <span class="deleteOne">Sil</span>
                        </td>
                        </tr>
                        <!-- <td class="checkbox">
                        <input type="checkbox" class="check-one check" />
                    </td>
                    <td class="goods">
                        <img src="https://i.imgyukle.com/2020/04/25/Q7D0SP.jpg" alt="" />
                        <span><a href="##" class="goodsTitle">Börek</a></span><br />
                        <span>from:</span><br />
                        <span><a href="##" class="sellerTitle">商家aaaaa</a></span>
                    </td>
                    <td class="price">200.63</td>
                    <td class="count">
                        <span class="reduce"></span>
                        <input type="text" class="count-input" value="1" />
                        <span class="add">+</span>
                    </td>
                    <td class="subtotal">200.63</td>
                    <td class="opration">
                        <span class="deleteOne">Sil</span>
                    </td> -->
                        <% }); %>
                        </tr>
                        <button href="Login" type="submit" style="    background-color: #fc5c00;
                        margin-top: 8px;
                        height: 50px;
                        font-size: 15px;
                        margin-left: 220px;
                                " class="mekanac">Mekan Aç</button>
    </form>
    <!-- <td class="checkbox">
                        <input type="checkbox" class="check-one check" />
                    </td> -->
    <!-- <td class="goods">
                        <img src="https://i.imgyukle.com/2020/04/25/Q7D0SP.jpg" alt="" />
                        <span><a href="##" class="goodsTitle">Börek</a></span><br />
                        <span>from:</span><br />
                        <span><a href="##" class="sellerTitle">商家aaaaa</a></span>
                    </td> -->
    <!-- <td class="price">200.63</td>
                    <td class="count">
                        <span class="reduce"></span>
                        <input type="text" class="count-input" value="1" />
                        <span class="add">+</span>
                    </td>
                    <td class="subtotal">200.63</td>
                    <td class="opration">
                        <span class="deleteOne">Sil</span>
                    </td>
                    </tr> -->
    </tbody>
    </table>

    </div>
    <div class="cartFooter" id="cartFooter">
        <div class="selall fl">
            <label for="fl select-all">
                <input type="checkbox" class="check-all check" />
                <span><a href="javascript:void(0)" class="selallSPAN">Tümü</a></span>
            </label>
        </div>
        <!-- <a href="#" id="multiDelete" class="fl delete">多 选 删 除</a>
            <a href="#" id="allDelete" class="fl delete">清 空 购 物 车</a> -->
        <div class="fr closing">Sipariş Ver</div>
        <div class="fr total">Total Fiyat<span id="priceTotal">0.00</span></div>
        <div class="fr selected" id="selected">
            Seçili Ürün
            <span id="selectedTotal">0</span>Adet
            <span class="arrow up">Seçili Ürünler</span>
            <span class="arrow down">︾</span>
        </div>
        <div class="selected-view">

            <div id="selectedViewList" class="clearfix">


            </div>


            <span class="arrow">◆<span>◆</span></span>
        </div>
    </div>
    </div>
</body>

<script>
    window.onload = function () {
        if (!document.getElementsByClassName) {
            document.getElementsByClassName = function (cls) {
                var ret = [];
                var els = document.getElementsByTagName('*');
                for (var i = 0; i < els.length; i++) {
                    if (
                        els[i].className === cls ||
                        els[i].className.indexOf(cls + ' ') >= 0 ||
                        els[i].className.indexOf(' ' + cls) >= 0 ||
                        els[i].className.indexOf(' ' + cls + ' ') >= 0
                    ) {
                        ret.push(els[i]);
                    }
                }
                return ret;
            };
        }
        var cartTable = document.getElementById('cartTable');
        var tr = cartTable.children[1].rows;
        var checkInputs = document.getElementsByClassName('check');
        var checkAllInput = document.getElementsByClassName('check-all');
        var selectedTotal = document.getElementById('selectedTotal');
        var priceTotal = document.getElementById('priceTotal');
        var selected = document.getElementById('selected');
        var cartFooter = document.getElementById('cartFooter');
        var selectedViewList = document.getElementById('selectedViewList');
        var multiDelete = document.getElementById('multiDelete');
        var allDelete = document.getElementById('allDelete');
        var selallSPAN = document.getElementsByClassName('selallSPAN');
        var urunadi = document.getElementById('ismibaba');


        for (var i = 0; i < checkInputs.length; i++) {
            checkInputs[i].onclick = function () {
                if (this.className === 'check-all check') {
                    for (var j = 0; j < checkInputs.length; j++) {
                        checkInputs[j].checked = this.checked;
                    }
                }
                if (this.checked == false) {
                    for (var k = 0; k < checkAllInput.length; k++) {
                        checkAllInput[k].checked = false;
                    }
                }
                getTotal();
            };
        }
        selallSPAN[0].onclick = selallSPAN[1].onclick = function () {
            for (var k = 0; k < checkAllInput.length; k++) {
                if (checkAllInput[k].checked) {
                    checkAllInput[k].checked = false;
                } else {
                    checkAllInput[k].checked = true;
                }
            }
            for (var j = 0; j < checkInputs.length; j++) {
                checkInputs[j].checked = checkAllInput[0].checked;
            }
            getTotal();
        };

        function getTotal() {
            var selected = 0;
            var price = 0;
            var urunAdi = '';
            var HTMLstr = '';

            for (var i = 0; i < tr.length; i++) {
                var perCount = tr[i].getElementsByTagName('input')[1].value;
                urunSayisi = tr[i].getElementsByTagName('input')[1].value;

                if (tr[i].getElementsByTagName('input')[0].checked) {
                    tr[i].className = 'on';
                    urunAdi = tr[i].querySelector(".goods span .goodsTitle").innerText;


                    selected += parseInt(tr[i].getElementsByTagName('input')[1].value);
                    price += parseFloat(tr[i].cells[4].innerHTML);
                    HTMLstr +=
                        '<div><img src="' +
                        tr[i].getElementsByTagName('img')[0].src +
                        '"/><span class="selCount" name="batu_' +
                        i +
                        '">' +
                        perCount +
                        '</span><input class="del" name="Urun_' +
                        i +
                        '">' + urunAdi + '</input></div>';
                } else {
                    tr[i].className = ' ';
                }
            }
            selectedTotal.innerHTML = selected;
            priceTotal.innerHTML = price.toFixed(2);
            selectedViewList.innerHTML = HTMLstr;
            if (selected == 0) {
                cartFooter.className = 'cartFooter';
            }
        }

        selected.onclick = function () {
            if (cartFooter.className == 'cartFooter') {
                if (selectedTotal.innerHTML != 0) {
                    cartFooter.className = 'cartFooter show';
                }
            } else {
                cartFooter.className = 'cartFooter';
            }
        };


        selectedViewList.onclick = function (e) {
            e = e || window.event;
            var el = e.srcElement;
            if (el.className == 'del') {
                var index = el.getAttribute('name');
                var input = tr[index].getElementsByTagName('input')[0];
                input.checked = false;
                input.onclick();
            }
        };


        for (var i = 0; i < tr.length; i++) {

            tr[i].onclick = function (e) {
                e = e || window.event;
                document.onselectstart = new Function('event.returnValue=false;');
                var el = e.target || e.srcElement;
                var cls = el.className;
                var input = this.getElementsByTagName('input')[1];
                var val = parseInt(input.value);
                var reduce = this.getElementsByTagName('span')[3];
                switch (cls) {
                    case 'add':
                        input.value = val + 1;
                        reduce.innerHTML = '-';
                        getSubtotal(this);
                        break;
                    case 'reduce':
                        if (val > 1) {
                            input.value = val - 1;
                            getSubtotal(this);
                        }
                        if (input.value <= 1) {
                            reduce.innerHTML = '';
                        }
                        break;
                    case 'deleteOne':
                        var conf = confirm('确定要删除吗？');
                        if (conf) {
                            this.parentNode.removeChild(this);
                        }
                        break;
                    default:
                        break;
                }
                if (input.value == 20) {
                    alert("Çok fazla Ürün Seçtiniz");
                    input.value = 0;
                }
                getTotal();
            };
            tr[i].getElementsByTagName('input')[1].onkeyup = function () {
                var val = parseInt(this.value);
                var tr = this.parentNode.parentNode;
                var reduce = tr.getElementsByTagName('span')[3];
                if (isNaN(val) || val < 1) {
                    val = 1;
                }
                this.value = val;
                if (val <= 1) {
                    reduce.innerHTML = '';
                } else {
                    reduce.innerHTML = '-';
                }
                getSubtotal(tr);
                getTotal();
            };
        }

        function getSubtotal(tr) {
            var tds = tr.cells;
            var price = parseFloat(tds[2].innerHTML);
            var count = tr.getElementsByTagName('input')[1].value;
            var subTotal = parseFloat(price * count).toFixed(2);
            tds[4].innerHTML = subTotal;
        }


        multiDelete.onclick = function () {
            if (selectedTotal.innerHTML != '0') {
                var conf = confirm('确定删除吗？');
                if (conf) {
                    cartDel();
                    getTotal();
                }
            }
        };
        allDelete.onclick = function () {
            var conf = confirm('Emin misiniz？');
            if (conf) {
                checkAllInput[0].checked = true;
                checkAllInput[0].onclick();
                cartDel();
                getTotal();
            }
        };
        function cartDel() {
            for (var i = 0; i < tr.length; i++) {
                var input = tr[i].getElementsByTagName('input')[0];
                if (input.checked) {
                    tr[i].parentNode.removeChild(tr[i]);
                    i--;
                }
            }
        }
    };

</script>


</html>